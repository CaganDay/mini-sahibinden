<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Complex SQL Queries - Mini Sahibinden</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        .query-card { transition: transform 0.2s; }
        .query-card:hover { transform: translateY(-3px); }
    </style>
</head>
<body class="bg-light">

<nav class="navbar navbar-expand-lg navbar-dark bg-warning pb-3 pt-3" style="background-color: #f8f9fa!important; border-bottom: 1px solid #ddd;">
    <div class="container">
        <a class="navbar-brand fw-bold text-dark" th:href="@{/}">mini<span class="bg-warning px-1 rounded border border-dark">sahibinden</span>.com</a>
        <div class="navbar-nav ms-auto">
            <a class="btn btn-outline-dark btn-sm" th:href="@{/}">
                <i class="fa-solid fa-home"></i> Home
            </a>
        </div>
    </div>
</nav>

<div class="container mt-4">
    <div class="row mb-4">
        <div class="col-12">
            <h2 class="mb-3"><i class="fa-solid fa-database text-primary"></i> Complex SQL Queries - Vehicle Database</h2>
            <p class="text-muted">Explore advanced SQL queries with different filtering and aggregation capabilities for our vehicle marketplace.</p>
        </div>
    </div>

    <div class="row g-4">
        <!-- Query 1: Active Sellers -->
        <div class="col-md-6">
            <div class="card shadow-sm query-card h-100">
                <div class="card-header bg-primary text-white">
                    <h5 class="mb-0"><i class="fa-solid fa-users"></i> Query 1: Active Sellers</h5>
                </div>
                <div class="card-body">
                    <p class="text-muted small">Find vehicles from sellers who have posted multiple listings (uses subquery with GROUP BY and HAVING).</p>
                    <form th:action="@{/queries/active-users}" method="get">
                        <div class="mb-3">
                            <label for="minListingCount1" class="form-label">Minimum Listings</label>
                            <input type="number" class="form-control" id="minListingCount1" 
                                   name="minListingCount" value="2" min="1" required>
                        </div>
                        <button type="submit" class="btn btn-primary w-100">
                            <i class="fa-solid fa-search"></i> Execute Query
                        </button>
                    </form>
                </div>
            </div>
        </div>

        <!-- Query 2: Above Average Price -->
        <div class="col-md-6">
            <div class="card shadow-sm query-card h-100">
                <div class="card-header bg-success text-white">
                    <h5 class="mb-0"><i class="fa-solid fa-chart-line"></i> Query 2: Above Average Price</h5>
                </div>
                <div class="card-body">
                    <p class="text-muted small">Find vehicles priced above the overall average (uses correlated subquery).</p>
                    <form th:action="@{/queries/above-average}" method="get">
                        <p class="text-info"><i class="fa-solid fa-info-circle"></i> No parameters needed</p>
                        <button type="submit" class="btn btn-success w-100">
                            <i class="fa-solid fa-search"></i> Execute Query
                        </button>
                    </form>
                </div>
            </div>
        </div>

        <!-- Query 3: Price and Seller Filter -->
        <div class="col-md-6">
            <div class="card shadow-sm query-card h-100">
                <div class="card-header bg-warning text-dark">
                    <h5 class="mb-0"><i class="fa-solid fa-filter"></i> Query 3: Price & Seller Filter</h5>
                </div>
                <div class="card-body">
                    <p class="text-muted small">Filter by price range and seller name pattern (uses JOIN with multiple WHERE conditions).</p>
                    <form th:action="@{/queries/price-user-filter}" method="get">
                        <div class="mb-2">
                            <label for="minPrice3" class="form-label">Min Price (TL)</label>
                            <input type="number" class="form-control form-control-sm" id="minPrice3" 
                                   name="minPrice" value="0" min="0" step="1">
                        </div>
                        <div class="mb-2">
                            <label for="maxPrice3" class="form-label">Max Price (TL)</label>
                            <input type="number" class="form-control form-control-sm" id="maxPrice3" 
                                   name="maxPrice" value="5000000" min="0" step="1">
                        </div>
                        <div class="mb-3">
                            <label for="userName3" class="form-label">Seller Name Pattern</label>
                            <input type="text" class="form-control form-control-sm" id="userName3" 
                                   name="userNamePattern" placeholder="e.g., Ali">
                        </div>
                        <button type="submit" class="btn btn-warning w-100">
                            <i class="fa-solid fa-search"></i> Execute Query
                        </button>
                    </form>
                </div>
            </div>
        </div>

        <!-- Query 4: Top Per Year -->
        <div class="col-md-6">
            <div class="card shadow-sm query-card h-100">
                <div class="card-header bg-info text-white">
                    <h5 class="mb-0"><i class="fa-solid fa-trophy"></i> Query 4: Top Vehicles Per Year</h5>
                </div>
                <div class="card-body">
                    <p class="text-muted small">Get top N vehicles per model year ranked by price (uses window function ROW_NUMBER).</p>
                    <form th:action="@{/queries/top-per-year}" method="get">
                        <div class="mb-3">
                            <label for="topN4" class="form-label">Top N Vehicles Per Year</label>
                            <input type="number" class="form-control" id="topN4" 
                                   name="topN" value="3" min="1" max="10" required>
                        </div>
                        <button type="submit" class="btn btn-info w-100 text-white">
                            <i class="fa-solid fa-search"></i> Execute Query
                        </button>
                    </form>
                </div>
            </div>
        </div>

    </div>
</div>

<footer class="mt-5 py-3 text-center text-muted border-top">
    <small>&copy; 2025 Mini-Sahibinden Car Marketplace</small>
</footer>

</body>
</html>

